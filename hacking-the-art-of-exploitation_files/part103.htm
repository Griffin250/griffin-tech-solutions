<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>0x471 Stealth SYN Scan</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part102.htm">&lt; Previous</a><span> | </span><a href="../hacking-the-art-of-exploitation.html">Contents</a><span> | </span><a href="part104.htm">Next &gt;</a></p><p class="s32" style="padding-left: 91pt;text-indent: 0pt;text-align: left;"><a name="bookmark92">0x471 Stealth SYN Scan</a></p><p style="padding-top: 6pt;padding-left: 91pt;text-indent: 0pt;text-align: left;">A SYN scan is also sometimes called a <span class="s27">half-open </span>scan. This is because it doesn’t actually open a full TCP connection. Recall the TCP/IP handshake: When a full connection is made, first a SYN packet is sent, then a SYN/ACK packet is sent back, and finally an ACK packet is returned to complete the handshake and open the connection. A SYN scan doesn’t complete the handshake, so a full connection is never opened. Instead, only the initial SYN packet is sent, and the response is examined. If a SYN/ACK packet is received in response, that port must be accepting connections. This is recorded, and an RST packet is sent to tear down the connection to prevent the service from accidentally being DoSed.</p><p style="padding-left: 91pt;text-indent: 17pt;line-height: 106%;text-align: left;">Using nmap, a SYN scan can be performed using the command-line option <span class="s31">-sS</span>. The program must be run as root, since the program isn’t using standard sockets and needs raw network access.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 91pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="444" height="1" alt="image" src="Image_779.png"/></span></p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">reader@hacking:~/booksrc $ sudo nmap -sS 192.168.42.72</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;"><a href="http://insecure.org/" class="s81" target="_blank">Starting Nmap 4.20 ( </a>http://insecure.org ) at 2007-05-29 09:19 PDT Interesting ports on 192.168.42.72:</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">Not shown: 1696 closed ports PORT  STATE SERVICE</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;line-height: 10pt;text-align: left;">22/tcp  open ssh</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s31" style="padding-top: 4pt;padding-bottom: 3pt;padding-left: 91pt;text-indent: 0pt;text-align: left;">Nmap finished: 1 IP address (1 host up) scanned in 0.094 seconds</p><p style="padding-left: 91pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="444" height="1" alt="image" src="Image_780.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part102.htm">&lt; Previous</a><span> | </span><a href="../hacking-the-art-of-exploitation.html">Contents</a><span> | </span><a href="part104.htm">Next &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
