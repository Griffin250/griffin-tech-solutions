<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>0x762 Exhaustive Brute-Force Attacks</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part183.htm">&lt; Previous</a><span> | </span><a href="../hacking-the-art-of-exploitation.html">Contents</a><span> | </span><a href="part185.htm">Next &gt;</a></p><p class="s32" style="padding-left: 91pt;text-indent: 0pt;text-align: left;"><a name="bookmark169">0x762 Exhaustive Brute-Force Attacks</a></p><p style="padding-top: 7pt;padding-left: 91pt;text-indent: 0pt;text-align: left;">A dictionary attack that tries every single possible combination is an <span class="s27">exhaustive brute-force </span>attack. While this type of attack will technically be able to crack every conceivable password, it will probably take longer than your grand- children’s grandchildren would be willing to wait.</p><p style="padding-left: 91pt;text-indent: 17pt;line-height: 108%;text-align: left;">With 95 possible input characters for <span class="s31">crypt()-</span>style passwords, there are 95<span class="s41">8</span> possible passwords for an exhaustive search of all eight-character</p><p style="padding-left: 91pt;text-indent: 0pt;line-height: 108%;text-align: left;">passwords, which works out to be over seven quadrillion possible passwords. This number gets so big so quickly because, as another character is added to the password length, the number of possible passwords grows exponentially. Assuming 10,000 cracks per second, it would take about 22,875 years to try every password. Distributing this effort across many machines and processors is one possible approach; however, it is important to remember that this will only achieve a linear speedup. If one thousand machines were combined, each capable of 10,000 cracks per second, the effort would still take over 22 years. The linear speedup achieved by adding another machine is marginal compared to the growth in keyspace when another character is added to the password length.</p><p style="padding-left: 91pt;text-indent: 17pt;line-height: 108%;text-align: left;">Luckily, the inverse of the exponential growth is also true; as characters are removed from the password length, the number of possible passwords decreases exponentially. This means that a four-character password only has 95<span class="s41">4</span> possible passwords. This keyspace has only about 84 million possible pass- words, which can be exhaustively cracked (assuming 10,000 cracks per second) in a little over two hours. This means that, even though a password like <span class="s31">h4R% </span>isn’t in any dictionary, it can be cracked in a reasonable amount of time.</p><p style="padding-left: 91pt;text-indent: 17pt;line-height: 108%;text-align: justify;">This means that, in addition to avoiding dictionary words, password length is also important. Since the complexity scales up exponentially, doubling the length to produce an eight-character password should bring the level of effort required to crack the password into the unreasonable time frame.</p><p style="padding-left: 91pt;text-indent: 17pt;line-height: 108%;text-align: left;">Solar Designer has developed a password-cracking program called John the Ripper that uses first a dictionary attack and then an exhaustive brute- force attack. This program is probably the most popular one of its kind;</p><p style="padding-left: 91pt;text-indent: 0pt;line-height: 108%;text-align: left;"><a href="http://www.openwall.com/john" class="a" target="_blank">it is available at </a>http://www.openwall.com/john. It has been included on the LiveCD.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 91pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="444" height="1" alt="image" src="Image_1296.png"/></span></p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">reader@hacking:~/booksrc $ john</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;line-height: 21pt;text-align: left;">John the Ripper Version 1.6 Copyright (c) 1996-98 by Solar Designer Usage: john [OPTIONS] [PASSWORD-FILES]</p><p class="s31" style="padding-top: 1pt;padding-left: 91pt;text-indent: 0pt;text-align: left;">-single         &quot;single crack&quot; mode</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">-wordfile:FILE -stdin  wordlist mode, read words from FILE or stdin</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">-rules          enable rules for wordlist mode</p><p class="s31" style="padding-top: 2pt;padding-left: 91pt;text-indent: 0pt;text-align: left;">-incremental[:MODE]   incremental mode [using section MODE]</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">-external:MODE     external mode or word filter</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">-stdout[:LENGTH]     no cracking, just write words to stdout</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">-restore[:FILE]     restore an interrupted session [from FILE]</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">-session:FILE      set session file name to FILE</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">-status[:FILE]     print status of a session [from FILE]</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">-makechars:FILE     make a charset, FILE will be overwritten</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">-show         show cracked passwords</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">-test          perform a benchmark</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">-users:[-]LOGIN|UID[,..] load this (these) user(s) only</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">-groups:[-]GID[,..]   load users of this (these) group(s) only</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">-shells:[-]SHELL[,..]  load users with this (these) shell(s) only</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">-salts:[-]COUNT     load salts with at least COUNT passwords only</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">-format:NAME     force ciphertext format NAME (DES/BSDI/MD5/BF/AFS/LM)</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;line-height: 106%;text-align: left;">-savemem:LEVEL     enable memory saving, at LEVEL 1..3 reader@hacking:~/booksrc $ sudo tail -3 /etc/shadow matrix:$1$zCcRXVsm$GdpHxqC9epMrdQcayUx0//:13763:0:99999:7::: jose:$1$pRS4.I8m$Zy5of8AtD800SeMgm.2Yg.:13786:0:99999:7:::</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;line-height: 107%;text-align: left;">reader:U6aMy0wojraho:13764:0:99999:7::: reader@hacking:~/booksrc $ sudo john /etc/shadow</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">Loaded 2 passwords with 2 different salts (FreeBSD MD5 [32/32]) guesses: 0 time: 0:00:00:01 0% (2) c/s: 5522 trying: koko</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">guesses: 0 time: 0:00:00:03 6% (2) c/s: 5489 trying: exports</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">guesses: 0 time: 0:00:00:05 10% (2) c/s: 5561 trying: catcat</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">guesses: 0 time: 0:00:00:09 20% (2) c/s: 5514 trying: dilbert!</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;line-height: 107%;text-align: left;">guesses: 0 time: 0:00:00:10 22% (2) c/s: 5513 trying: redrum3 testing7    (jose)</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">guesses: 1 time: 0:00:00:14 44% (2) c/s: 5539 trying: KnightKnight</p><p class="s31" style="padding-bottom: 3pt;padding-left: 91pt;text-indent: 0pt;text-align: left;">guesses: 1 time: 0:00:00:17 59% (2) c/s: 5572 trying: Gofish! Session aborted</p><p style="padding-left: 91pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="444" height="1" alt="image" src="Image_1297.png"/></span></p><p style="padding-top: 7pt;padding-left: 109pt;text-indent: 0pt;text-align: left;">In this output, the account jose is shown to have the password of <span class="s31">testing7</span>.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part183.htm">&lt; Previous</a><span> | </span><a href="../hacking-the-art-of-exploitation.html">Contents</a><span> | </span><a href="part185.htm">Next &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
