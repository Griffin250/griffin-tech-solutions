<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>0x460 TCP/IP Hijacking</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part98.htm">&lt; Previous</a><span> | </span><a href="../hacking-the-art-of-exploitation.html">Contents</a><span> | </span><a href="part100.htm">Next &gt;</a></p><p class="s30" style="padding-left: 37pt;text-indent: 0pt;text-align: left;"><a name="bookmark88">0x460 TCP/IP Hijacking</a></p><p class="s27" style="padding-top: 9pt;padding-left: 91pt;text-indent: 0pt;line-height: 106%;text-align: justify;">TCP/IP hijacking <span class="p">is a clever technique that uses spoofed packets to take over a connection between a victim and a host machine. This technique is exception- ally useful when the victim uses a one-time password to connect to the host machine. A one-time password can be used to authenticate once and only once, which means that sniffing the authentication is useless for the attacker.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="71" height="1" alt="image" src="Image_762.png"/></span></p><p class="s82" style="padding-top: 1pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">src : 192.168.0.100</p><p class="s82" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">dst : 192.168.0.200</p><p class="s82" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">seq #: 1429775000</p><p class="s82" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">ack #: 1250510000</p><p class="s82" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">len  2<span class="s92">4</span></p><p style="text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><span><img width="72" height="6" alt="image" src="Image_763.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="103" height="1" alt="image" src="Image_764.png"/></span></p><p class="s82" style="padding-top: 2pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">src : 192.168.0.200</p><p class="s82" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">dst : 192.168.0.100</p><p class="s82" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">seq #: 1250510000</p><p class="s82" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">ack #: 1429775024</p><p class="s82" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">len  167</p><p style="text-indent: 0pt;text-align: left;"/><p class="s82" style="padding-top: 2pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">src : 192.168.0.100</p><p class="s82" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">dst : 192.168.0.200</p><p class="s82" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">seq #: 1429775024</p><p class="s82" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">ack #: 1250510167</p><p class="s82" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">len  71</p><p style="text-indent: 0pt;text-align: left;"/><p class="s93" style="padding-top: 5pt;padding-left: 1pt;text-indent: 0pt;text-align: center;">System B</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s82" style="padding-left: 1pt;text-indent: 0pt;text-align: center;">192.168.0.200</p><p style="text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><span><img width="39" height="6" alt="image" src="Image_765.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="145" height="102" alt="image" src="Image_766.png"/></span></p><p style="padding-left: 91pt;text-indent: 17pt;line-height: 108%;text-align: left;">To carry out a TCP/IP hijacking attack, the attacker must be on the same network as the victim. By sniffing the local network segment, all of the details of open TCP connections can be pulled from the headers. As we have seen, each TCP packet contains a sequence number in its header. This sequence number is incremented with each packet sent to ensure that packets are received in the correct order. While sniffing, the attacker has access to the sequence numbers for a connection between a victim (system A in the follow- ing illustration) and a host machine (system B). Then the attacker sends a spoofed packet from the victim’s IP address to the host machine, using the sniffed sequence number to provide the proper acknowledgment number, as shown here.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s93" style="padding-top: 5pt;padding-left: 1pt;text-indent: 0pt;text-align: center;">System A</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s82" style="padding-left: 1pt;text-indent: 0pt;text-align: center;">192.168.0.100</p><p class="s16" style="padding-left: 92pt;text-indent: 0pt;text-align: left;"> </p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s93" style="padding-left: 16pt;text-indent: -2pt;text-align: left;">Attacker system</p><p style="padding-left: 219pt;text-indent: 0pt;text-align: left;"/><p style="padding-top: 3pt;padding-left: 91pt;text-indent: 17pt;line-height: 108%;text-align: left;">The host machine will receive the spoofed packet with the correct acknowledgment number and will have no reason to believe it didn’t come from the victim machine.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part98.htm">&lt; Previous</a><span> | </span><a href="../hacking-the-art-of-exploitation.html">Contents</a><span> | </span><a href="part100.htm">Next &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
