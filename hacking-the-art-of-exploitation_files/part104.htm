<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>0x472 FIN, X-mas, and Null Scans</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part103.htm">&lt; Previous</a><span> | </span><a href="../hacking-the-art-of-exploitation.html">Contents</a><span> | </span><a href="part105.htm">Next &gt;</a></p><p class="s32" style="padding-left: 91pt;text-indent: 0pt;text-align: left;"><a name="bookmark93">0x472 FIN, X-mas, and Null Scans</a></p><p style="padding-top: 6pt;padding-left: 91pt;text-indent: 0pt;text-align: left;">In response to SYN scanning, new tools to detect and log half-open connections were created. So yet another collection of techniques for stealth port scanning evolved: FIN, X-mas, and Null scans. These all involve sending a nonsensical packet to every port on the target system. If a port is listening, these packets just get ignored. However, if the port is closed and the implementation follows protocol (RFC 793), an RST packet will be sent. This difference can be used to detect which ports are accepting connections, without actually opening any connections.</p><p style="padding-left: 91pt;text-indent: 17pt;text-align: left;">The FIN scan sends a FIN packet, the X-mas scan sends a packet with FIN, URG, and PUSH turned on (so named because the flags are lit up like a</p><p style="padding-top: 3pt;padding-left: 91pt;text-indent: 0pt;text-align: left;">Christmas tree), and the Null scan sends a packet with no TCP flags set. While these types of scans are stealthier, they can also be unreliable. For instance, Microsoft’s implementation of TCP doesn’t send RST packets like it should, making this form of scanning ineffective.</p><p style="padding-left: 91pt;text-indent: 17pt;text-align: left;">Using nmap, FIN, X-mas, and NULL scans can be performed using the command-line options <span class="s31">-sF</span>, <span class="s31">-sX</span>, and <span class="s31">-sN</span>, respectively. Their output looks basically the same as the previous scan.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part103.htm">&lt; Previous</a><span> | </span><a href="../hacking-the-art-of-exploitation.html">Contents</a><span> | </span><a href="part105.htm">Next &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
