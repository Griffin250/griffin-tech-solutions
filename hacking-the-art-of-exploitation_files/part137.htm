<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>0x640 Log Files</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part136.htm">&lt; Previous</a><span> | </span><a href="../hacking-the-art-of-exploitation.html">Contents</a><span> | </span><a href="part138.htm">Next &gt;</a></p><p class="s30" style="padding-top: 3pt;padding-left: 37pt;text-indent: 0pt;text-align: left;"><a name="bookmark124">0x640 Log Files</a></p><p style="padding-top: 7pt;padding-left: 91pt;text-indent: 0pt;line-height: 108%;text-align: left;">One of the two most obvious signs of intrusion is the log file. The log file kept by the tinyweb daemon is one of the first places to look into when trouble- shooting a problem. Even though the attacker’s exploits were successful, the log file keeps a painfully obvious record that something is up.</p><p class="s40" style="padding-top: 8pt;padding-left: 19pt;text-indent: 0pt;text-align: left;">tinywebd Log File</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 19pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="540" height="1" alt="image" src="Image_1021.png"/></span></p><p class="s31" style="padding-left: 19pt;text-indent: 0pt;line-height: 107%;text-align: left;">reader@hacking:~/booksrc $ sudo cat /var/log/tinywebd.log 07/25/2007 14:55:45&gt; Starting up.</p><p class="s31" style="padding-left: 19pt;text-indent: 0pt;line-height: 10pt;text-align: left;">07/25/2007 14:57:00&gt; From 127.0.0.1:38127 &quot;HEAD / HTTP/1.0&quot;   200 OK</p><p class="s31" style="padding-left: 19pt;text-indent: 0pt;text-align: left;">07/25/2007 17:49:14&gt; From 127.0.0.1:50201 &quot;GET / HTTP/1.1&quot;   200 OK</p><p class="s31" style="padding-left: 19pt;text-indent: 0pt;text-align: left;">07/25/2007 17:49:14&gt; From 127.0.0.1:50202 &quot;GET /image.jpg HTTP/1.1&quot;   200 OK</p><p class="s31" style="padding-left: 19pt;text-indent: 0pt;text-align: left;">07/25/2007 17:49:14&gt; From 127.0.0.1:50203 &quot;GET /favicon.ico HTTP/1.1&quot;  404 Not Found 07/25/2007 17:57:21&gt; Shutting down.</p><p class="s31" style="padding-left: 19pt;text-indent: 0pt;text-align: left;">08/01/2007 15:43:08&gt; Starting up..</p><p class="s31" style="padding-left: 19pt;text-indent: 0pt;text-align: left;">08/01/2007 15:43:41&gt; From 127.0.0.1:45396 &quot;<span class="s66">□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□</span></p><p class="s66" style="padding-top: 1pt;padding-left: 19pt;text-indent: 0pt;text-align: left;">□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□</p><p class="s66" style="padding-top: 1pt;padding-left: 19pt;text-indent: 0pt;text-align: left;">□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□</p><p class="s66" style="padding-left: 19pt;text-indent: 0pt;line-height: 10pt;text-align: left;">□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□<span class="s31">jfX</span>□<span class="s31">1</span>□<span class="s31">CRj j </span>□□ □<span class="s31">jfXCh </span>□□</p><p class="s31" style="padding-left: 23pt;text-indent: 0pt;line-height: 10pt;text-align: left;">f<span class="s66">□</span>T$ fhzifS<span class="s66">□□</span>j QV<span class="s66">□□</span>C <span class="s66">□□□□</span>I<span class="s66">□</span>? Iy<span class="s66">□□</span></p><p class="s31" style="padding-left: 180pt;text-indent: 0pt;text-align: left;">Rh//shh/bin<span class="s66">□□</span>R<span class="s66">□□</span>S<span class="s66">□□ </span>$<span class="s66">□□□</span>$<span class="s66">□□□</span>$<span class="s66">□□□</span>$<span class="s66">□□□</span>$<span class="s66">□□□</span>$<span class="s66">□</span></p><p class="s66" style="padding-left: 19pt;text-indent: 0pt;text-align: left;">□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□</p><p class="s66" style="padding-bottom: 2pt;padding-left: 19pt;text-indent: 0pt;line-height: 107%;text-align: left;">□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">$</span>□□□<span class="s31">&quot;  NOT HTTP! reader@hacking:~/booksrc $</span></p><p style="padding-left: 19pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="540" height="1" alt="image" src="Image_1022.png"/></span></p><p style="padding-top: 6pt;padding-left: 91pt;text-indent: 17pt;line-height: 108%;text-align: justify;">Of course in this case, after the attacker gains a root shell, he can just edit the log file since it’s on the same system. On secure networks, however, copies of logs are often sent to another secure server. In extreme cases, logs are sent to a printer for hard copy, so there is a physical record. These types of counter- measures prevent tampering with the logs after successful exploitation.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part136.htm">&lt; Previous</a><span> | </span><a href="../hacking-the-art-of-exploitation.html">Contents</a><span> | </span><a href="part138.htm">Next &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
