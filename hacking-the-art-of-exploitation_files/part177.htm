<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>0x742 Peter Shor’s Quantum Factoring Algorithm</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part176.htm">&lt; Previous</a><span> | </span><a href="../hacking-the-art-of-exploitation.html">Contents</a><span> | </span><a href="part178.htm">Next &gt;</a></p><p class="s32" style="padding-left: 91pt;text-indent: 0pt;text-align: left;"><a name="bookmark162">0x742 Peter Shor’s Quantum Factoring Algorithm</a></p><p style="padding-top: 6pt;padding-left: 91pt;text-indent: 0pt;line-height: 108%;text-align: left;">Once again, quantum computation promises amazing increases in computa- tion potential. Peter Shor was able to take advantage of the massive parallelism of quantum computers to efficiently factor numbers using an old number- theory trick.</p><p style="padding-top: 3pt;padding-left: 91pt;text-indent: 17pt;text-align: left;">The algorithm is actually quite simple. Take a number, <span class="s27">N, </span>to factor. Choose a value, <span class="s27">A, </span>that is less than <span class="s27">N</span>. This value should also be relatively prime to <span class="s27">N</span>, but assuming that <span class="s27">N </span>is the product of two prime numbers (which will always be the case when trying to factor numbers to break RSA), if <span class="s27">A </span>isn’t relatively prime to <span class="s27">N</span>, then <span class="s27">A </span>is one of <span class="s27">N</span>’s factors.</p><p style="padding-left: 91pt;text-indent: 17pt;line-height: 108%;text-align: left;">Next, load up the superposition with sequential numbers counting up from 1 and feed every one of those values through the function <span class="s27">f</span>(<span class="s27">x</span>)= <span class="s27">A</span><span class="s111">x</span>(mod<span class="s27">N </span>). This is all done at the same time, through the magic</p><p style="padding-left: 91pt;text-indent: 0pt;line-height: 108%;text-align: left;">of quantum computation. A repeating pattern will emerge in the results, and the period of this repetition must be found. Luckily, this can be done quickly on a quantum computer with a Fourier transform. This period will be called <span class="s27">R</span>.</p><p style="padding-left: 109pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Then, simply calculate gcd(<span class="s27">A</span><span class="s111">R</span><span class="s41">/2</span> + 1, <span class="s27">N</span>) and gcd(<span class="s27">A</span><span class="s111">R</span><span class="s41">/2</span> <span class="s47"></span><span class="s95"> </span>1, <span class="s27">N</span>). At least one</p><p class="s27" style="padding-left: 91pt;text-indent: 0pt;text-align: left;"><span class="p">of these values should be a factor of </span>N<span class="p">. This is possible because </span>A<span class="s111">R</span> <span class="p">= 1(mod</span>N<span class="p">) and is further explained below.</span></p><p class="s27" style="padding-top: 6pt;padding-left: 109pt;text-indent: 0pt;line-height: 155%;text-align: left;">A<span class="s111">R</span> <span class="p">= 1(mod</span>N<span class="p">) (</span>A<span class="s111">R</span><span class="s41">/2</span><span class="p">)</span><span class="s41">2</span><span class="p"> = 1(mod</span>N<span class="p">)</span></p><p style="padding-left: 109pt;text-indent: 0pt;line-height: 12pt;text-align: left;">(<span class="s27">A</span><span class="s111">R</span><span class="s41">/2</span>)<span class="s41">2</span> <span class="s47"></span><span class="s95"> </span>1 = 0(mod<span class="s27">N </span>)</p><p style="padding-top: 5pt;padding-left: 109pt;text-indent: 0pt;text-align: left;">(<span class="s27">A</span><span class="s111">R</span><span class="s41">/2</span> <span class="s47"></span><span class="s95"> </span>1) · (<span class="s27">A</span><span class="s111">R</span><span class="s41">/2</span> + 1) = 0(mod<span class="s27">N </span>)</p><p style="padding-top: 5pt;padding-left: 91pt;text-indent: 18pt;text-align: left;">This means that (<span class="s27">A</span><span class="s111">R</span><span class="s41">/2</span> <span class="s47"></span><span class="s95"> </span>1) · (<span class="s27">A</span><span class="s111">R</span><span class="s41">/2</span> + 1) is an integer multiple of <span class="s27">N</span>. As long as these values don’t zero themselves out, one of them will have a factor in common with <span class="s27">N</span>.</p><p style="padding-left: 91pt;text-indent: 18pt;text-align: left;">To crack the previous RSA example, the public value <span class="s27">N </span>must be factored. In this case <span class="s27">N </span>equals 143. Next, a value for <span class="s27">A </span>is chosen that is relatively prime to and less than <span class="s27">N</span>, so <span class="s27">A </span>equals 21. The function will look like <span class="s27">f</span>(<span class="s27">x</span>)= 21<span class="s111">x</span>(mod143). Every sequential value from 1 up to as high as the quantum computer will allow will be put through this function.</p><p style="padding-left: 91pt;text-indent: 17pt;line-height: 108%;text-align: left;">To keep this brief, the assumption will be that the quantum computer has three quantum bits, so the superposition can hold eight values.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:106.935pt" cellspacing="0"><tr style="height:14pt"><td style="width:10pt"><p class="s116" style="padding-left: 2pt;text-indent: 0pt;text-align: left;">x</p></td><td style="width:10pt"><p class="s117" style="text-indent: 0pt;text-align: center;">=</p></td><td style="width:21pt;border-right-style:solid;border-right-width:1pt"><p class="s117" style="padding-left: 2pt;text-indent: 0pt;text-align: left;">1</p></td><td style="width:75pt;border-left-style:solid;border-left-width:1pt"><p class="s117" style="padding-right: 2pt;text-indent: 0pt;text-align: right;">211(mod143)</p></td><td style="width:10pt"><p class="s117" style="text-indent: 0pt;text-align: center;">=</p></td><td style="width:21pt"><p class="s117" style="padding-left: 2pt;text-indent: 0pt;text-align: left;">21</p></td></tr><tr style="height:14pt"><td style="width:10pt"><p class="s116" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">x</p></td><td style="width:10pt"><p class="s117" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">=</p></td><td style="width:21pt;border-right-style:solid;border-right-width:1pt"><p class="s117" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">2</p></td><td style="width:75pt;border-left-style:solid;border-left-width:1pt"><p class="s117" style="padding-top: 1pt;padding-right: 2pt;text-indent: 0pt;text-align: right;">212(mod143)</p></td><td style="width:10pt"><p class="s117" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">=</p></td><td style="width:21pt"><p class="s117" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">12</p></td></tr><tr style="height:14pt"><td style="width:10pt"><p class="s116" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">x</p></td><td style="width:10pt"><p class="s117" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">=</p></td><td style="width:21pt;border-right-style:solid;border-right-width:1pt"><p class="s117" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">3</p></td><td style="width:75pt;border-left-style:solid;border-left-width:1pt"><p class="s117" style="padding-top: 1pt;padding-right: 2pt;text-indent: 0pt;text-align: right;">213(mod143)</p></td><td style="width:10pt"><p class="s117" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">=</p></td><td style="width:21pt"><p class="s117" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">109</p></td></tr><tr style="height:14pt"><td style="width:10pt"><p class="s116" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">x</p></td><td style="width:10pt"><p class="s117" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">=</p></td><td style="width:21pt;border-right-style:solid;border-right-width:1pt"><p class="s117" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">4</p></td><td style="width:75pt;border-left-style:solid;border-left-width:1pt"><p class="s117" style="padding-top: 1pt;padding-right: 2pt;text-indent: 0pt;text-align: right;">214(mod143)</p></td><td style="width:10pt"><p class="s117" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">=</p></td><td style="width:21pt"><p class="s117" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">1</p></td></tr><tr style="height:14pt"><td style="width:10pt"><p class="s116" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">x</p></td><td style="width:10pt"><p class="s117" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">=</p></td><td style="width:21pt;border-right-style:solid;border-right-width:1pt"><p class="s117" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">5</p></td><td style="width:75pt;border-left-style:solid;border-left-width:1pt"><p class="s117" style="padding-top: 1pt;padding-right: 2pt;text-indent: 0pt;text-align: right;">215(mod143)</p></td><td style="width:10pt"><p class="s117" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">=</p></td><td style="width:21pt"><p class="s117" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">21</p></td></tr><tr style="height:14pt"><td style="width:10pt"><p class="s116" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">x</p></td><td style="width:10pt"><p class="s117" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">=</p></td><td style="width:21pt;border-right-style:solid;border-right-width:1pt"><p class="s117" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">6</p></td><td style="width:75pt;border-left-style:solid;border-left-width:1pt"><p class="s117" style="padding-top: 1pt;padding-right: 2pt;text-indent: 0pt;text-align: right;">216(mod143)</p></td><td style="width:10pt"><p class="s117" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">=</p></td><td style="width:21pt"><p class="s117" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">12</p></td></tr><tr style="height:14pt"><td style="width:10pt"><p class="s116" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">x</p></td><td style="width:10pt"><p class="s117" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">=</p></td><td style="width:21pt;border-right-style:solid;border-right-width:1pt"><p class="s117" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">7</p></td><td style="width:75pt;border-left-style:solid;border-left-width:1pt"><p class="s117" style="padding-top: 1pt;padding-right: 2pt;text-indent: 0pt;text-align: right;">217(mod143)</p></td><td style="width:10pt"><p class="s117" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">=</p></td><td style="width:21pt"><p class="s117" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">109</p></td></tr><tr style="height:15pt"><td style="width:10pt"><p class="s116" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">x</p></td><td style="width:10pt"><p class="s117" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">=</p></td><td style="width:21pt;border-right-style:solid;border-right-width:1pt"><p class="s117" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">8</p></td><td style="width:75pt;border-left-style:solid;border-left-width:1pt"><p class="s117" style="padding-top: 1pt;padding-right: 2pt;text-indent: 0pt;text-align: right;">218(mod143)</p></td><td style="width:10pt"><p class="s117" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">=</p></td><td style="width:21pt"><p class="s117" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">1</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 91pt;text-indent: 18pt;text-align: left;">Here the period is easy to determine by eye: <span class="s27">R </span>is 4. Armed with this information, gcd(21<span class="s41">2</span> <span class="s47"></span><span class="s95"> </span>1143) and gcd(21<span class="s41">2</span> + 1143) should produce at least one of the factors. This time, both factors actually appear, since gcd(440, 143) = 11 and gcd(442, 142) = 13. These factors can then be used to recalculate the private key for the previous RSA example.</p><p class="toc">&nbsp;</p><div class="toc"><a class="toc0" href="part178.htm">0x750 Hybrid Ciphers</a></div><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part176.htm">&lt; Previous</a><span> | </span><a href="../hacking-the-art-of-exploitation.html">Contents</a><span> | </span><a href="part178.htm">Next &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
