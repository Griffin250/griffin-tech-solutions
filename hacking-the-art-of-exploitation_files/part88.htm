<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>0x441 Raw Socket Sniffer</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part87.htm">&lt; Previous</a><span> | </span><a href="../hacking-the-art-of-exploitation.html">Contents</a><span> | </span><a href="part89.htm">Next &gt;</a></p><p class="s32" style="padding-left: 91pt;text-indent: 0pt;text-align: left;"><a name="bookmark77">0x441 Raw Socket Sniffer</a></p><p style="padding-top: 5pt;padding-left: 91pt;text-indent: 0pt;line-height: 107%;text-align: left;">So far in our code examples, we have been using stream sockets. When sending and receiving using stream sockets, the data is neatly wrapped in a TCP/IP connection. Accessing the OSI model of the session (5) layer, the operating system takes care of all of the lower-level details of transmission, correction, and routing. It is possible to access the network at lower layers using raw sockets. At this lower layer, all the details are exposed and must be handled explicitly by the programmer. Raw sockets are specified by using <span class="s31">SOCK_RAW </span>as the type. In this case, the protocol matters since there are multiple options. The protocol can be <span class="s31">IPPROTO_TCP</span>, <span class="s31">IPPROTO_UDP</span>, or <span class="s31">IPPROTO_ICMP</span>. The following example is a TCP sniffing program using raw sockets.</p><p class="s40" style="padding-top: 8pt;padding-left: 91pt;text-indent: 0pt;text-align: left;">raw_tcpsniff.c</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 91pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="444" height="1" alt="image" src="Image_681.png"/></span></p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;line-height: 107%;text-align: left;">#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; #include &lt;sys/socket.h&gt; #include &lt;netinet/in.h&gt; #include &lt;arpa/inet.h&gt;</p><p class="s31" style="padding-top: 1pt;padding-left: 91pt;text-indent: 0pt;line-height: 21pt;text-align: left;">#include &quot;hacking.h&quot; int main(void) {</p><p class="s31" style="padding-left: 104pt;text-indent: 0pt;line-height: 8pt;text-align: left;">int i, recv_length, sockfd;</p><p class="s31" style="padding-top: 2pt;padding-left: 104pt;text-indent: 0pt;text-align: left;">u_char buffer[9000];</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s31" style="padding-left: 116pt;text-indent: -12pt;line-height: 107%;text-align: left;">if ((sockfd = socket(PF_INET, SOCK_RAW, IPPROTO_TCP)) == -1) fatal(&quot;in socket&quot;);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s31" style="padding-left: 104pt;text-indent: 0pt;text-align: left;">for(i=0; i &lt; 3; i++) {</p><p class="s31" style="padding-left: 116pt;text-indent: 0pt;line-height: 107%;text-align: left;">recv_length = recv(sockfd, buffer, 8000, 0); printf(&quot;Got a %d byte packet\n&quot;, recv_length); dump(buffer, recv_length);</p><p class="s31" style="padding-left: 104pt;text-indent: 0pt;line-height: 10pt;text-align: left;">}</p><p class="s31" style="padding-bottom: 3pt;padding-left: 91pt;text-indent: 0pt;text-align: left;">}</p><p style="padding-left: 91pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="444" height="1" alt="image" src="Image_682.png"/></span></p><p style="padding-top: 8pt;padding-left: 91pt;text-indent: 18pt;text-align: left;">This program opens a raw TCP socket and listens for three packets, print- ing the raw data of each one with the <span class="s31">dump() </span>function. Notice that buffer is declared as a <span class="s31">u_char </span>variable. This is just a convenience type definition from sys/socket.h that expands to “unsigned char.” This is for convenience, since unsigned variables are used a lot in network programming and typing <span class="s31">unsigned </span>every time is a pain.</p><p style="padding-left: 91pt;text-indent: 17pt;text-align: left;">When compiled, the program needs to be run as root, because the use of raw sockets requires root access. The following output shows the program sniffing the network while we’re sending sample text to our simple_server.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 91pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="444" height="1" alt="image" src="Image_683.png"/></span></p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">reader@hacking:~/booksrc $ gcc -o raw_tcpsniff raw_tcpsniff.c reader@hacking:~/booksrc $ ./raw_tcpsniff</p><p class="s31" style="padding-left: 91pt;text-indent: 0pt;text-align: left;">[!!] Fatal Error in socket: Operation not permitted reader@hacking:~/booksrc $ sudo ./raw_tcpsniff</p><table style="border-collapse:collapse;margin-left:88.94pt" cellspacing="0"><tr style="height:11pt"><td style="width:285pt" colspan="15"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Got a 68 byte packet</p></td></tr><tr style="height:10pt"><td style="width:13pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">45</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">10</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">00</p></td><td style="width:51pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">44 1e 36 40</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">00</p></td><td style="width:12pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">40</p></td><td style="width:13pt"><p class="s42" style="padding-right: 2pt;text-indent: 0pt;line-height: 9pt;text-align: right;">06</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">46</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">23</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">c0</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">a8</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">2a</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">01</p></td><td style="width:9pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">|</p></td><td style="width:72pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">E..D.6@.@.F#..*.</p></td></tr><tr style="height:11pt"><td style="width:13pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">c0</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">a8</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">2a</p></td><td style="width:51pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">f9 8b 12 1e</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">d2</p></td><td style="width:12pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">ac</p></td><td style="width:13pt"><p class="s42" style="padding-right: 2pt;text-indent: 0pt;line-height: 9pt;text-align: right;">14</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">cf</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">92</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">e5</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">10</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">6c</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">c9</p></td><td style="width:9pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">|</p></td><td style="width:72pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">..*.     l.</p></td></tr><tr style="height:11pt"><td style="width:13pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">80</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">18</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">05</p></td><td style="width:51pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">b4 32 47 00</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">00</p></td><td style="width:12pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">01</p></td><td style="width:13pt"><p class="s42" style="padding-right: 2pt;text-indent: 0pt;line-height: 9pt;text-align: right;">01</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">08</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">0a</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">26</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">ab</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">9a</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">f1</p></td><td style="width:9pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">|</p></td><td style="width:72pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">....2G......&amp;...</p></td></tr><tr style="height:11pt"><td style="width:13pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">02</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">3b</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">65</p></td><td style="width:51pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">b7 74 68 69</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">73</p></td><td style="width:12pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">20</p></td><td style="width:13pt"><p class="s42" style="padding-right: 2pt;text-indent: 0pt;line-height: 9pt;text-align: right;">69</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">73</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">20</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">61</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">20</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">74</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">65</p></td><td style="width:9pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">|</p></td><td style="width:72pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">.;e.this is a te</p></td></tr><tr style="height:10pt"><td style="width:13pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">73</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">74</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">0d</p></td><td style="width:51pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">0a</p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:12pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:12pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:12pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:9pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">|</p></td><td style="width:72pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">st..</p></td></tr><tr style="height:11pt"><td style="width:285pt" colspan="15"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Got a 70 byte packet</p></td></tr><tr style="height:11pt"><td style="width:13pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">45</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">10</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">00</p></td><td style="width:51pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">46 1e 37 40</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">00</p></td><td style="width:12pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">40</p></td><td style="width:13pt"><p class="s42" style="padding-right: 2pt;text-indent: 0pt;line-height: 9pt;text-align: right;">06</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">46</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">20</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">c0</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">a8</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">2a</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">01</p></td><td style="width:9pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">|</p></td><td style="width:72pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">E..F.7@.@.F ..*.</p></td></tr><tr style="height:11pt"><td style="width:13pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">c0</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">a8</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">2a</p></td><td style="width:51pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">f9 8b 12 1e</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">d2</p></td><td style="width:12pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">ac</p></td><td style="width:13pt"><p class="s42" style="padding-right: 2pt;text-indent: 0pt;line-height: 9pt;text-align: right;">14</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">cf</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">a2</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">e5</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">10</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">6c</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">c9</p></td><td style="width:9pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">|</p></td><td style="width:72pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">..*.     l.</p></td></tr><tr style="height:11pt"><td style="width:13pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">80</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">18</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">05</p></td><td style="width:51pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">b4 27 95 00</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">00</p></td><td style="width:12pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">01</p></td><td style="width:13pt"><p class="s42" style="padding-right: 2pt;text-indent: 0pt;line-height: 9pt;text-align: right;">01</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">08</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">0a</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">26</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">ab</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">a0</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">75</p></td><td style="width:9pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">|</p></td><td style="width:72pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">....&#39;.   &amp;..u</p></td></tr><tr style="height:11pt"><td style="width:13pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">02</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">3c</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">1b</p></td><td style="width:51pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">28 41 41 41</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">41</p></td><td style="width:12pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">41</p></td><td style="width:13pt"><p class="s42" style="padding-right: 2pt;text-indent: 0pt;line-height: 9pt;text-align: right;">41</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">41</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">41</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">41</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">41</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">41</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">41</p></td><td style="width:9pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">|</p></td><td style="width:72pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">.&lt;.(AAAAAAAAAAAA</p></td></tr><tr style="height:10pt"><td style="width:13pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">41</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">41</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">41</p></td><td style="width:51pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">41 0d 0a</p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:12pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:12pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:12pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:9pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">|</p></td><td style="width:72pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">AAAA..</p></td></tr><tr style="height:11pt"><td style="width:285pt" colspan="15"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Got a 71 byte packet</p></td></tr><tr style="height:11pt"><td style="width:13pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">45</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">10</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">00</p></td><td style="width:51pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">47 1e 38 40</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">00</p></td><td style="width:12pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">40</p></td><td style="width:13pt"><p class="s42" style="padding-right: 2pt;text-indent: 0pt;line-height: 9pt;text-align: right;">06</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">46</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">1e</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">c0</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">a8</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">2a</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">01</p></td><td style="width:9pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">|</p></td><td style="width:72pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">E..G.8@.@.F...*.</p></td></tr><tr style="height:11pt"><td style="width:13pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">c0</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">a8</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">2a</p></td><td style="width:51pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">f9 8b 12 1e</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">d2</p></td><td style="width:12pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">ac</p></td><td style="width:13pt"><p class="s42" style="padding-right: 2pt;text-indent: 0pt;line-height: 9pt;text-align: right;">14</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">cf</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">b4</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">e5</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">10</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">6c</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">c9</p></td><td style="width:9pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">|</p></td><td style="width:72pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">..*.     l.</p></td></tr><tr style="height:11pt"><td style="width:13pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">80</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">18</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">05</p></td><td style="width:51pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">b4 68 45 00</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">00</p></td><td style="width:12pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">01</p></td><td style="width:13pt"><p class="s42" style="padding-right: 2pt;text-indent: 0pt;line-height: 9pt;text-align: right;">01</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">08</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">0a</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">26</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">ab</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">b6</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">e7</p></td><td style="width:9pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">|</p></td><td style="width:72pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">....hE......&amp;...</p></td></tr><tr style="height:11pt"><td style="width:13pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">02</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">3c</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">20</p></td><td style="width:51pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">ad 66 6a 73</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">64</p></td><td style="width:12pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">61</p></td><td style="width:13pt"><p class="s42" style="padding-right: 2pt;text-indent: 0pt;line-height: 9pt;text-align: right;">6c</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">6b</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">66</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">6a</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">61</p></td><td style="width:12pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">73</p></td><td style="width:13pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">6b</p></td><td style="width:9pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">|</p></td><td style="width:72pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">.&lt; .fjsdalkfjask</p></td></tr><tr style="height:10pt"><td style="width:13pt"><p class="s42" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">66</p></td><td style="width:13pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">6a</p></td><td style="width:13pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">61</p></td><td style="width:51pt"><p class="s42" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">73 64 0d 0a</p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:12pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:12pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:12pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:13pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:9pt"><p class="s42" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">|</p></td><td style="width:72pt"><p class="s42" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">fjasd..</p></td></tr></table><p class="s31" style="padding-bottom: 3pt;padding-left: 91pt;text-indent: 0pt;text-align: left;">reader@hacking:~/booksrc $</p><p style="padding-left: 91pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="444" height="1" alt="image" src="Image_684.png"/></span></p><p style="padding-top: 7pt;padding-left: 91pt;text-indent: 17pt;text-align: left;">While this program will capture packets, it isn’t reliable and will miss some packets, especially when there is a lot of traffic. Also, it only captures TCP packets—to capture UDP or ICMP packets, additional raw sockets need to be opened for each. Another big problem with raw sockets is that they are notoriously inconsistent between systems. Raw socket code for Linux most likely won’t work on BSD or Solaris. This makes multiplatform programming with raw sockets nearly impossible.</p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part87.htm">&lt; Previous</a><span> | </span><a href="../hacking-the-art-of-exploitation.html">Contents</a><span> | </span><a href="part89.htm">Next &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
